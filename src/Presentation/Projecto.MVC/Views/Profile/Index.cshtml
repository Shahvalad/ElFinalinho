@model ProfileViewModel
@section ViewProfileStyles {
    <style>
        .user-info__avatar div {
            opacity: 0;
        }

        .badge-image {
            width: 100px; 
            height: 145px; 
        }
        .user-post{
            width: 100% !important
        }
    </style>
}
<main class="page-main">
    <div class="uk-grid" data-uk-grid="">
        <div class="uk-width-2-3@l uk-first-column">
            <div class="widjet --profile">
                <div class="widjet__head">
                    <h3 class="uk-text-lead">Profile</h3>
                </div>
                <div class="widjet__body">
                    <div class="user-info">
                        <form id="uploadForm" method="post" asp-action="ChangeProfilePicture" asp-controller="Profile" enctype="multipart/form-data">
                            <div class="user-info__avatar" style="position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                                <img src="@(string.IsNullOrEmpty(Model.User.ProfilePicture) ? Url.Content("~/Images/ProfilePictures/profile.png") : Url.Content($"~/Images/ProfilePictures/{Model.User.ProfilePicture}"))" alt="profile" id="profilePic" style="width: 100%; height: 100%; object-fit: cover;">
                                <div style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.5); color: #fff; text-align: center; opacity: 0; transition: opacity 0.3s ease;">
                                    <input type="file" id="file" name="file" style="display: none;" onchange="document.getElementById('uploadForm').submit();" />
                                    <label for="file" style="cursor: pointer; padding: 10px;">Change Picture</label>
                                </div>
                            </div>
                        </form>

                        <div class="user-info__box">
                            <div class="user-info__title">@Model.User.Username</div>
                            <div class="user-info__text">@Model.User.RegistrationDate.ToString("D")</div>
                        </div>
                    </div><a class="uk-button uk-button-danger" asp-action="Edit"><i class="ico_edit"></i><span class="uk-margin-small-left">Edit Profile</span></a>
                </div>
            </div>
            @if (!String.IsNullOrEmpty(Model.User.Bio))
            {
                <div class="widjet --bio">
                    <div class="widjet__head">
                        <h3 class="uk-text-lead">Bio</h3>
                    </div>
                    <div class="widjet__body"><span>@Model.User.Bio</span></div>
                </div>
            }
            <div class="widjet --body">
                @if(Model.DisplayedPost != null)
                {
                    <img class="user-post" src="~/images//CommunityPosts/@Model.DisplayedPost.CommunityPostImage.FileName" />
                }
            </div>

            <div class="widjet --activity">
                <div class="widjet__head">
                    <h3 class="uk-text-lead">Games</h3><a href="~/#!">View All</a>
                </div>
                @foreach (var game in Model.User.Games)
                {
                    <div class="widjet__body">
                        <div class="widjet-game">
                            <div class="widjet-game__media">
                                <a asp-controller="Store" asp-action="Details" asp-route-id="@game.Id">
                                    <img style="width: 100px; height: auto;" src="~/Images/Games/@game.CoverImageFileName" alt="image">
                                </a>
                            </div>
                            <div class="widjet-game__info">
                                <a class="widjet-game__title" asp-controller="Store" asp-action="Details" asp-route-id="@game.Id"> @game.Name</a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
        <div class="uk-width-1-3@l">
            <div class="widjet --badges">
                <div class="widjet__head">
                    <h3 class="uk-text-lead">Badges</h3>
                    <div>
                        <a asp-controller="Profile" asp-action="ViewAllBadges">View All</a>
                        <span> | </span>
                        <a asp-action="EditBadges"> Edit</a>
                    </div>
                </div>
                <div class="widjet__body">
                    <ul class="badges-list">
                        @foreach (var tarotCard in Model.User.TarotCards)
                        {
                            <li><img class="badge-image" src="~/Images/TarotCards/@tarotCard.TarotCard.Image" alt="badge"></li>
                        }
                    </ul>
                </div>
            </div>
            
        </div>
    </div>
</main>
@section ProfileButtonScript {
    <script>
        document.querySelector('.user-info__avatar').addEventListener('mouseover', function () {
            this.querySelector('div').style.opacity = 1;
        });

        document.querySelector('.user-info__avatar').addEventListener('mouseout', function () {
            this.querySelector('div').style.opacity = 0;
        });
    </script>
}