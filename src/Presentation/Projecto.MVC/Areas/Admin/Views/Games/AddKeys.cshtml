@model GetGameDto
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
<h2>Add Game Keys</h2>
<form asp-action="AddKeys" asp-controller="Games" method="post" enctype="multipart/form-data">
    <input type="hidden" asp-for="Id" />
    <div class="form-group">
        <label for="keys">Keys</label>
        <textarea class="form-control" id="keys" name="Keys" rows="5"></textarea>
        <small class="form-text text-muted">Enter each key on a new line.</small>
    </div>
    <span>You can upload keys from excel file: </span>
    <div class="form-group">
        <label>File: </label>
        <input type="file" class="form-control" id="excelFile" name="file" />
    </div>
    <button type="submit" class="btn btn-primary">Add Keys</button>
</form>

<div id="fileContent" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc; overflow: auto; height: 200px;"></div>

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script>
    document.getElementById('excelFile').addEventListener('change', function (evt) {
        var files = evt.target.files;
        var file = files[0];
        var reader = new FileReader();
        reader.onload = function (e) {
            var data = new Uint8Array(e.target.result);
            var workbook = XLSX.read(data, { type: 'array' });

            var result = '';
            workbook.SheetNames.forEach(function (sheetName) {
                var roa = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], { header: 1 });
                if (roa.length) result += roa.join("\n");
            });

            document.getElementById('fileContent').innerText = result;
        };
        reader.readAsArrayBuffer(file);
    });
</script>